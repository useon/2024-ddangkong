# cd frontend && npm run build-dev



# 현재 브랜치 이름 가져오기
current_branch=$(git rev-parse --abbrev-ref HEAD)


# 브랜치 패턴을 변수로 선언
branch_patterns=("feat/" "hotfix/" "fix/" "refactor/" "test/")

# 브랜치가 패턴에 맞는지 확인하는 함수
matches_pattern() {
  local branch=$1
  for pattern in "${branch_patterns[@]}"; do
    if [[ $branch == $pattern* ]]; then
      return 0
    fi
  done
  return 1
}

# feat/ 로 시작하는 브랜치인지 확인
if matches_pattern "$current_branch"; then
    echo "Feature branch detected: $current_branch"
    echo "Starting rebase process..."

    # develop 브랜치로 전환 및 최신 변경사항 가져오기
    git checkout develop
    git pull origin develop

    # 원래 브랜치로 돌아가기
    git checkout $current_branch

    # rebase 수행
    if git rebase develop; then
        echo "Rebase completed successfully."
        echo "Push completed."
        exit 0
    else
        echo "Rebase failed. Please resolve conflicts manually."
        echo "After resolving conflicts, run:"

        exit 1
    fi
else
    echo "Not a feature branch. Proceeding with normal push."
    exit 0
fi
